<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ことばあそび（クイズのみPWA）</title>

  <link rel="stylesheet" href="./style.css">
  <meta a name="theme-color" content="#0b213d">

  <!-- iOS用 -->
  <link rel="apple-touch-icon" href="./eta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>
<body>
  <main id="app">
    <!-- ホーム -->
    <section id="home" class="screen active" aria-label="ホーム">
      <h1 class="brand">ことばあそび</h1>
      <p class="sub">きいて えらんで たのしく まなぼう！</p>

      <!-- 上部ボタン -->
      <div class="row top-actions">
        <button id="startBtn" class="btn primary big">はじめる</button>
        <button id="rewardsBtn" class="btn ghost big">ごほうび</button>
        <button id="parentBtn" class="btn ghost small">ほごしゃ</button>
      </div>

      <!-- 英語音声選択 -->
      <section class="card voice-card" aria-label="えいご の おんせい">
        <h2 class="card-title">えいご の おんせい</h2>
        <div class="row wrap">
          <label class="block">
            えらぶ：
            <select id="voiceSelect" class="voice-select" aria-label="英語 音声をえらんでね"></select>
          </label>
          <button id="voiceTestBtn" class="btn ghost small">テスト再生</button>
        </div>
        <p class="hint">※ おんせいのリストは すこし まってから ひょうじされます</p>
      </section>

      <!-- 出題設定 -->
      <section class="card settings-card" aria-label="出題設定">
        <h2 class="card-title">出題設定</h2>
        <div class="field">
          <label class="block">通番の範囲（<span id="rangeMinMax">-</span>）
            <div class="row wrap">
              <input id="rangeStart" type="number" class="num" />
              <span>〜</span>
              <input id="rangeEnd" type="number" class="num" />
            </div>
          </label>
        </div>
        <div class="field">
          <label class="block">品詞（複数えらべます）</label>
          <div id="posFilter" class="chips"></div>
        </div>
        <p id="startError" class="error" hidden></p>
      </section>

      <p id="homeHint" class="hint">※ はじめは サンプルのことば（sample.csv）を つかいます</p>
    </section>

    <!-- クイズ -->
    <section id="quiz" class="screen">
      <div class="quiz-head">
        <span id="quizWord" class="quiz-word">apple</span>
        <button id="quizReplayBtn" class="btn round">🔊</button>
      </div>
      <div id="choices" class="grid-2x2"></div>
      <div id="progress" class="progress">0 / 5</div>
    </section>

    <!-- ごほうび -->
    <section id="reward" class="screen">
      <p class="big">やったね！</p>
      <div id="stickerSpot" class="sticker"></div>
      <div class="row">
        <button id="nextRoundBtn" class="btn primary">つづける</button>
        <button id="toHomeBtn" class="btn ghost">おわる</button>
      </div>
    </section>

    <!-- ごほうび一覧 -->
    <section id="rewards" class="screen">
      <h2 class="brand">ごほうび</h2>
      <p class="hint">直近30日分を ひょうじします</p>
      <div id="rewardsList" class="rewards-list"></div>
      <div class="row">
        <button id="rewardsBackBtn" class="btn ghost">もどる</button>
      </div>
    </section>

    <!-- 保護者 -->
    <section id="parent" class="screen">
      <h2>保護者メニュー</h2>
      <div id="parentGate" class="card">
        <p>ボタンを3びょう おしてから、1+2 をいれてください。</p>
        <div class="row">
          <button id="holdButton" class="btn">ながおし</button>
          <input id="gateAnswer" type="number" />
          <button id="enterParent" class="btn">ひらく</button>
        </div>
      </div>
      <div id="parentPanel" class="card" hidden>
        <label class="file">
          CSV をよみこむ
          <input id="csvInput" type="file" accept=".csv" />
        </label>
        <div class="row wrap">
          <label>1かいの もんだいすう
            <select id="sessionSize">
              <option value="5">5</option>
              <option value="10">10</option>
            </select>
          </label>
        </div>
        <button id="resetProgress" class="btn warn">しんちょくリセット</button>
        <button id="backHome" class="btn ghost">もどる</button>
        <details><summary>ログ</summary><pre id="devLog"></pre></details>
      </div>
    </section>
  </main>

  <div id="markOverlay" class="mark-overlay"></div>
  <canvas id="confetti" class="confetti-canvas"></canvas>

  <script src="./app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js');
      });
    }
  </script>
</body>
</html>
