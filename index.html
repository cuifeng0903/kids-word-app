<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ことばあそび（クイズのみ）</title>
  <!-- style -->
  <link rel="stylesheet" href="style.css">
  <meta name="color-scheme" content="light">
</head>
<body>
  <main id="app">
    <!-- ホーム（出題設定つき） -->
    <section id="home" class="screen active" aria-label="ホーム">
      <h1 class="brand">ことばあそび</h1>
      <p class="sub">きいて えらんで たのしく まなぼう！</p>

      <!-- 出題設定 -->
      <section class="card" aria-label="出題設定">
        <h2 class="card-title">出題設定</h2>

        <div class="field">
          <label class="block">通番の範囲（<span id="rangeMinMax">-</span>）
            <div class="row wrap">
              <input id="rangeStart" type="number" class="num" aria-label="通番開始" />
              <span>〜</span>
              <input id="rangeEnd" type="number" class="num" aria-label="通番終了" />
            </div>
          </label>
          <p class="hint">※ CSVの「通番」列を使います</p>
        </div>

        <div class="field">
          <label class="block">品詞（複数えらべます）</label>
          <div id="posFilter" class="chips" role="group" aria-label="品詞フィルタ">
            <!-- CSV読込後に自動生成（既定で全選択） -->
          </div>
          <p class="hint">未選択の場合は自動で「全品詞」として扱います</p>
        </div>

        <p id="startError" class="error" aria-live="polite" hidden></p>
      </section>

      <div class="row">
        <button id="startBtn" class="btn primary big">はじめる</button>
        <button id="parentBtn" class="btn ghost small" aria-label="保護者メニュー">ほごしゃ</button>
      </div>

      <p id="homeHint" class="hint">※ はじめは サンプルのことば（sample.csv）を つかいます</p>
    </section>

    <!-- クイズ（4択のみ） -->
    <section id="quiz" class="screen" aria-label="クイズ">
      <div class="quiz-head">
        <span id="quizWord" class="quiz-word">apple</span>
        <button id="quizReplayBtn" class="btn round" aria-label="もういちどきく">🔊</button>
      </div>
      <div id="choices" class="grid-2x2" role="group" aria-label="えらんでね"></div>
      <div id="progress" class="progress" aria-live="polite">0 / 5</div>
    </section>

    <!-- ごほうび -->
    <section id="reward" class="screen" aria-label="ごほうび">
      <p class="big">やったね！</p>
      <div id="stickerSpot" class="sticker" aria-hidden="true"></div>
      <div class="row">
        <button id="nextRoundBtn" class="btn primary">つづける</button>
        <button id="toHomeBtn" class="btn ghost">おわる</button>
      </div>
    </section>

    <!-- 保護者 -->
    <section id="parent" class="screen" aria-label="保護者メニュー">
      <h2>保護者メニュー</h2>

      <div id="parentGate" class="card">
        <p>ボタンを <strong>3 びょう</strong> おしてから、<strong>1 + 2</strong> を いれてください。</p>
        <div class="row">
          <button id="holdButton" class="btn">ながおし</button>
          <input id="gateAnswer" type="number" inputmode="numeric" placeholder="答え" aria-label="答え" />
          <button id="enterParent" class="btn">ひらく</button>
        </div>
      </div>

      <div id="parentPanel" class="card" hidden>
        <div class="field">
          <label class="file">
            CSV をよみこむ
            <input id="csvInput" type="file" accept=".csv" />
          </label>
          <p class="hint">CSV ヘッダー：<code>通番,英単語,日本語訳,品詞</code></p>
        </div>

        <div class="row wrap">
          <label>1かいの もんだいすう
            <select id="sessionSize">
              <option value="5" selected>5</option>
              <option value="10">10</option>
            </select>
          </label>
          <label>TTSことば
            <select id="ttsLang">
              <option value="en-US" selected>en-US</option>
              <option value="en-GB">en-GB</option>
            </select>
          </label>
          <label>はやさ <input id="ttsRate" type="range" min="0.7" max="1.1" step="0.05" value="0.95"/></label>
          <label>ピッチ <input id="ttsPitch" type="range" min="0.8" max="1.2" step="0.05" value="1.05"/></label>
        </div>

        <div class="row">
          <button id="resetProgress" class="btn warn">しんちょくリセット</button>
          <button id="backHome" class="btn ghost">もどる</button>
        </div>

        <details>
          <summary>かいはつしゃログ</summary>
          <pre id="devLog"></pre>
        </details>
      </div>
    </section>
  </main>

  <!-- マーク表示（〇/× の大きな表示） -->
  <div id="markOverlay" class="mark-overlay" aria-hidden="true"></div>

  <!-- 紙吹雪キャンバス（下部噴水・豪華版） -->
  <canvas id="confetti" class="confetti-canvas" aria-hidden="true"></canvas>

  <!-- app -->
  <script src="./app.js"></script>
</body>
</html>
